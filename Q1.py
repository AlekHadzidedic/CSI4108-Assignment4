import RSA
import datetime

# Parameters
e = 65537
m = 466921883457309
p = 158940791390617637555578368883751031334824088450900487737568884742566188446578656183436663669979621650200092460009351826331716799917216276015789816882242856229648930600018644910601835588032964993198125935444743380456480664255743001127182766313491276728104716804299656754495099511928200610924904200874789947319
q = 115658828512835702666801371984404498072672611205741778628345514486538417913050412641398216992624155440611832395605350490561593623525594700995732910653703294184227239006795225464133065926561601227431633099692078425189407247177789369205124934636435914638599091294663188027405233340319798039587215824177967590819
n = 18382905735141838591031869140193776581485511019155258782093685810639131752157538536446591692557000934532254796139820933120767870116508174682408335706033418515141342507629014693503247662502787511283245854454268174237980117352116993370099093908662512375396763374561325881621445378305418542264011591453596123097096064691778601779483836085078906251909377573307687949453458669442439350409755625638284133668539711371871490828923880735803714812775190637247833502473510081576761084251851651230071966432870622329018152963255180815397779774161166302880623547351575533580810419665879500927217963619309979140901975053042358064261
phi_n = 18382905735141838591031869140193776581485511019155258782093685810639131752157538536446591692557000934532254796139820933120767870116508174682408335706033418515141342507629014693503247662502787511283245854454268174237980117352116993370099093908662512375396763374561325881621445378305418542264011591453596123096821465071875148439261456344210750722501880873651045683087544270213334744050126556813449253005935934281059565973309178418910404389332379660236310774937563931162884914645037780855337064918276056108388393928118359009751891862727633932548315846401648342214106611566916656145317630767061980490389855027989600526124
d = 14639959092333460206932364100189721548399732618563108192529651090447963799691142542880463863308170190518973626728804705164597669179103577539389020942444759640520196064828740465660848150647847606335450980080437292186137544668798422798809558087413560407236877959144899548948961634342351800912241283438935905714213386735681822825127381341431431290103920967369104892463618995304096621697792931927985059769882878647654636721926941257887769295091702269049754616114809561914406401728313119248403305450044741084656231507244480397271472481061742189015277613733329751517171466156706609002434702574503958797853391267159943547309
vpe = d % (p-1)
vqe = d % (q-1)

ciphertext = RSA.encrypt(m, e, n)

a = datetime.datetime.now()
message = RSA.decrypt_crt(ciphertext, d, n, p, q, vpe, vqe)
b = datetime.datetime.now()

c = datetime.datetime.now()
message_no_crt = RSA.decrypt_no_crt(ciphertext, d, n)
d = datetime.datetime.now()

print('Chinese remainder theorem time: ' + str((b-a).microseconds))
print('No chinese remainder theorem time: ' + str((d-c).microseconds))
